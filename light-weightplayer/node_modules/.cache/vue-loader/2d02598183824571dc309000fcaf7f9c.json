{"remainingRequest":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GH\\LWP\\light-weightplayer\\src\\views\\discover\\discoverChildren\\Ranking.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GH\\LWP\\light-weightplayer\\src\\views\\discover\\discoverChildren\\Ranking.vue","mtime":1636485287731},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\babel-loader\\lib\\index.js","mtime":1636408357214},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGhhbmRsZU11c2ljVGltZSB9IGZyb20gInBsdWdpbnMvdXRpbHMiOwoKaW1wb3J0IExpc3RUYWJsZSBmcm9tICJjb21wb25lbnRzL2xpc3RUYWJsZS9MaXN0VGFibGUudnVlIjsKaW1wb3J0IExpc3RDYXJkIGZyb20gImNvbXBvbmVudHMvbGlzdENhcmQvTGlzdENhcmQudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgTGlzdFRhYmxlLCBMaXN0Q2FyZCB9LAogIG5hbWU6ICJSYW5raW5nIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgb2ZmaWNpYWxMaXN0OiBbXSwKICAgICAgb2ZmaWNpYWxMaXN0RGV0YWlsOiBbXSwKICAgICAgZ2xvYmFsTGlzdDogW10sCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6K+35rGCCiAgICAvLyDor7fmsYLmiYDmnInmppzljZUKICAgIGFzeW5jIGdldEFsbFJhbmtpbmdzKCkgewogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kcmVxdWVzdCgiL3RvcGxpc3QiKTsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgdGhpcy5vZmZpY2lhbExpc3QgPSByZXMuZGF0YS5saXN0LnNsaWNlKDAsIDQpOwogICAgICB0aGlzLmdsb2JhbExpc3QgPSByZXMuZGF0YS5saXN0LnNsaWNlKDQpOwogICAgfSwKICAgIC8vIOagueaNruamnOWNlWlk6K+35rGC6K+m57uG5pWw5o2uCiAgICAvLyDmoLnmja7kvKDmnaXnmoQgaWQg5p+l6K+i5q2M5Y2VCiAgICBhc3luYyBnZXRNdXNpY0xpc3REZXRhaWwoaWQpIHsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcm91dGUucGFyYW1zLmlkKTsKICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJHJlcXVlc3QoIi9wbGF5bGlzdC9kZXRhaWwiLCB7IGlkIH0pOwogICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpOwogICAgICByZXN1bHQgPSByZXN1bHQuZGF0YS5wbGF5bGlzdDsKICAgICAgLy8g5a+55pe26Ze06L+b6KGM5aSE55CGCiAgICAgIHJlc3VsdC50cmFja3MuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICByZXN1bHQudHJhY2tzW2luZGV4XS5kdCA9IGhhbmRsZU11c2ljVGltZShpdGVtLmR0KTsKICAgICAgfSk7CiAgICAgIHRoaXMub2ZmaWNpYWxMaXN0RGV0YWlsLnB1c2gocmVzdWx0KTsKICAgIH0sCgogICAgLy8g5LqL5Lu25Ye95pWwCiAgICAvLyDooYzngrnlh7vkuovku7bnmoTlm57osIMKICAgIGhhbmRsZVJvd0NsaWNrKGV2ZW50KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGV2ZW50KTsKICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5zZWxlY3RSb3ciKSkgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5zZWxlY3RSb3ciKS5jbGFzc0xpc3QucmVtb3ZlKCJzZWxlY3RSb3ciKTsKICAgICAgfQogICAgICBldmVudC5jbGFzc0xpc3QuYWRkKCJzZWxlY3RSb3ciKTsKICAgIH0sCiAgICAvLyDooYzlj4zlh7vkuovku7bnmoTlm57osIMKICAgIC8vIGlkIOatjOWNlWlkICAgaW5kZXgg5Y+M5Ye75q2M5puy5Zyo5q2M5Y2V5Lit55qE57Si5byVCiAgICBoYW5kbGVSb3dEYkNsaWNrKHsgaWQsIGluZGV4IH0pIHsKICAgICAgLy8gY29uc29sZS5sb2coaWQpOwogICAgICAvLyBjb25zb2xlLmxvZyhpbmRleCk7CiAgICAgIGxldCBtdXNpY0xpc3RJbmRleCA9IHRoaXMub2ZmaWNpYWxMaXN0RGV0YWlsLmZpbmRJbmRleCgKICAgICAgICAoaXRlbSkgPT4gaXRlbS5pZCA9PSBpZAogICAgICApOwogICAgICBjb25zb2xlLmxvZyhtdXNpY0xpc3RJbmRleCk7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgKICAgICAgICAidXBkYXRlTXVzaWNJZCIsCiAgICAgICAgdGhpcy5vZmZpY2lhbExpc3REZXRhaWxbbXVzaWNMaXN0SW5kZXhdLnRyYWNrc1tpbmRleF0uaWQKICAgICAgKTsKICAgICAgLy8g5aaC5p6c5q2M5Y2V5Y+R55Sf5Y+Y5YyWLOWImeaPkOS6pOatjOWNleWIsHZ1ZXgKICAgICAgaWYgKGlkICE9IHRoaXMuJHN0b3JlLnN0YXRlLm11c2ljTGlzdElkKSB7CiAgICAgICAgLy8g5bCG5q2M5Y2V5Lyg5YiwdnVleAogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRlTXVzaWNMaXN0IiwgewogICAgICAgICAgbXVzaWNMaXN0OiB0aGlzLm9mZmljaWFsTGlzdERldGFpbFttdXNpY0xpc3RJbmRleF0udHJhY2tzLAogICAgICAgICAgbXVzaWNMaXN0SWQ6IGlkLAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8g54K55Ye75qac5Y2V6L+b5YWl5q2M5Y2V6K+m5oOF55WM6Z2iCiAgICBjbGlja0xpc3RDYXJkSXRlbShpZCkgewogICAgICBpZiAoIXRoaXMuJHN0b3JlLnN0YXRlLmlzTG9naW4pIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLnmbvlvZXlkI7miY3og73mn6XnnIvlhajpg6jmrYzmm7Llk6YhIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChpZC5pZCkgewogICAgICAgIGlkID0gaWQuaWQ7CiAgICAgIH0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAibXVzaWNMaXN0RGV0YWlsIiwgcGFyYW1zOiB7IGlkIH0gfSk7CiAgICB9LAogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGF3YWl0IHRoaXMuZ2V0QWxsUmFua2luZ3MoKTsKICAgIHRoaXMub2ZmaWNpYWxMaXN0LmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgdGhpcy5nZXRNdXNpY0xpc3REZXRhaWwoaXRlbS5pZCk7CiAgICB9KTsKICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub2ZmaWNpYWxMaXN0RGV0YWlsKTsKICB9LAp9Owo="},{"version":3,"sources":["Ranking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Ranking.vue","sourceRoot":"src/views/discover/discoverChildren","sourcesContent":["<template>\n  <!-- 请求到数据前先不进行渲染，避免报错和影响美观 -->\n  <div class=\"rankingContainer\">\n    <div class=\"ranking\" v-if=\"officialListDetail.length != 0\">\n      <div class=\"offical\">\n        <div class=\"title\">官方榜</div>\n        <!-- 用自己封装的table组件 -->\n        <list-table\n          :officialListDetailItem=\"item\"\n          v-for=\"(item, index) in officialListDetail\"\n          :key=\"index\"\n          @handleRowClick=\"handleRowClick\"\n          @handleRowDbClick=\"handleRowDbClick\"\n          @clickCheckAll=\"clickListCardItem\"\n        ></list-table>\n      </div>\n      <div class=\"global\">\n        <div class=\"title\">全球榜</div>\n        <!-- 展示歌单列表 -->\n        <list-card\n          class=\"listCard\"\n          :listCardData=\"globalList\"\n          @clickListCardItem=\"clickListCardItem\"\n        ></list-card>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { handleMusicTime } from \"plugins/utils\";\n\nimport ListTable from \"components/listTable/ListTable.vue\";\nimport ListCard from \"components/listCard/ListCard.vue\";\nexport default {\n  components: { ListTable, ListCard },\n  name: \"Ranking\",\n  data() {\n    return {\n      officialList: [],\n      officialListDetail: [],\n      globalList: [],\n    };\n  },\n  methods: {\n    // 请求\n    // 请求所有榜单\n    async getAllRankings() {\n      let res = await this.$request(\"/toplist\");\n      console.log(res);\n      this.officialList = res.data.list.slice(0, 4);\n      this.globalList = res.data.list.slice(4);\n    },\n    // 根据榜单id请求详细数据\n    // 根据传来的 id 查询歌单\n    async getMusicListDetail(id) {\n      // console.log(this.$route.params.id);\n      let result = await this.$request(\"/playlist/detail\", { id });\n      // console.log(result);\n      result = result.data.playlist;\n      // 对时间进行处理\n      result.tracks.forEach((item, index) => {\n        result.tracks[index].dt = handleMusicTime(item.dt);\n      });\n      this.officialListDetail.push(result);\n    },\n\n    // 事件函数\n    // 行点击事件的回调\n    handleRowClick(event) {\n      // console.log(event);\n      if (document.querySelector(\".selectRow\")) {\n        document.querySelector(\".selectRow\").classList.remove(\"selectRow\");\n      }\n      event.classList.add(\"selectRow\");\n    },\n    // 行双击事件的回调\n    // id 歌单id   index 双击歌曲在歌单中的索引\n    handleRowDbClick({ id, index }) {\n      // console.log(id);\n      // console.log(index);\n      let musicListIndex = this.officialListDetail.findIndex(\n        (item) => item.id == id\n      );\n      console.log(musicListIndex);\n      this.$store.commit(\n        \"updateMusicId\",\n        this.officialListDetail[musicListIndex].tracks[index].id\n      );\n      // 如果歌单发生变化,则提交歌单到vuex\n      if (id != this.$store.state.musicListId) {\n        // 将歌单传到vuex\n        this.$store.commit(\"updateMusicList\", {\n          musicList: this.officialListDetail[musicListIndex].tracks,\n          musicListId: id,\n        });\n      }\n    },\n    // 点击榜单进入歌单详情界面\n    clickListCardItem(id) {\n      if (!this.$store.state.isLogin) {\n        this.$message.error(\"登录后才能查看全部歌曲哦!\");\n        return;\n      }\n      if (id.id) {\n        id = id.id;\n      }\n      this.$router.push({ name: \"musicListDetail\", params: { id } });\n    },\n  },\n  async created() {\n    await this.getAllRankings();\n    this.officialList.forEach((item) => {\n      this.getMusicListDetail(item.id);\n    });\n    // console.log(this.officialListDetail);\n  },\n};\n</script>\n\n<style scoped>\n.rankingContainer {\n  display: flex;\n  justify-content: center;\n  width: 100%;\n}\n\n.ranking {\n  max-width: 1000px;\n  padding: 0 10px;\n}\n\n.listCard {\n  margin-top: 15px;\n}\n</style>"]}]}