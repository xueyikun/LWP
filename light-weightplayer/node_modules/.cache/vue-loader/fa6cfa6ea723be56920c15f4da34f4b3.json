{"remainingRequest":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\video\\videoChildren\\VideoList.vue?vue&type=style&index=0&id=0d83e3b4&scoped=true&lang=css&","dependencies":[{"path":"D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\video\\videoChildren\\VideoList.vue","mtime":1632135031000},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\css-loader\\dist\\cjs.js","mtime":1636408356404},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1636408358142},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\postcss-loader\\src\\index.js","mtime":1636408357193},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tdXNpY0xpc3ROYXZCYXIgewogIHBhZGRpbmc6IDEwcHggMjVweDsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBmb250LXNpemU6IDEycHg7Cn0KCi5wYWdlIHsKICB3aWR0aDogMTAwJTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgcGFkZGluZy1ib3R0b206IDIwcHg7Cn0KCi5jYXJkTGlzdCB7CiAgb3ZlcmZsb3cteTogc2Nyb2xsOwogIC8qIGhlaWdodDogY2FsYygxMDB2aCAtIDIxNXB4KTsgKi8KICBoZWlnaHQ6IGNhbGMoODB2aCAtIDIxNXB4KTsKfQo="},{"version":3,"sources":["VideoList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8IA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"VideoList.vue","sourceRoot":"src/views/video/videoChildren","sourcesContent":["<template>\n  <div class=\"videoList\">\n    <!-- 类名可能不太对应文件，因为html和样式都是直接搬MusicListIndex里面的 -->\n    <!-- 视频列表 -->\n    <!-- 视频navbar -->\n    <div class=\"musicListNavBar\" v-if=\"videoCategory.length != 0\">\n      <div class=\"left\">\n        <sort-box\n          :currentTag=\"currentTag\"\n          :sortList=\"sortList\"\n          @getSortList=\"getSortList\"\n          @clickSortBoxItem=\"clickSortBoxItem\"\n        ></sort-box>\n      </div>\n      <div class=\"right\">\n        <second-nav-bar\n          :SecondNavBarData=\"videoCategory\"\n          :itemWidth=\"0\"\n          :currentTag=\"currentTag\"\n          @clickSecondBarItem=\"clickSecondBarItem\"\n        ></second-nav-bar>\n      </div>\n    </div>\n    <!-- 视频卡片列表 -->\n    <video-list-card\n      :videoList=\"videoList\"\n      :isLoad=\"true\"\n      :videoType=\"'video'\"\n      class=\"cardList\"\n      @clickListCardItem=\"goToVideoDetail\"\n      @bottomLoad=\"bottomLoad\"\n    >\n    </video-list-card>\n    <go-top scrollObj=\".cardList\"></go-top>\n  </div>\n</template>\n\n<script>\nimport SecondNavBar from \"components/secondNavBar/SecondNavBar.vue\";\nimport VideoListCard from \"components/videoListCard/VideoListCard.vue\";\nimport GoTop from \"components/goTop/GoTop.vue\";\nimport SortBox from \"components/sortBox/SortBox.vue\";\nexport default {\n  components: { SecondNavBar, VideoListCard, GoTop, SortBox },\n  name: \"VideoList\",\n  data() {\n    return {\n      // 视频分类\n      videoCategory: [],\n      // 当前标签\n      currentTag: {},\n      // 当前视频页数\n      videoPage: 1,\n      // 是否还有更多视频数据\n      hasMore: true,\n      // 视频列表数据\n      videoList: [],\n      // 视频分类tag列表\n      sortList: [],\n    };\n  },\n  methods: {\n    // 请求\n    // 请求视频分类\n    async getVideoCategory() {\n      let res = await this.$request(\"/video/category/list\");\n      this.videoCategory = res.data.data;\n      this.currentTag = res.data.data[0];\n      // console.log(this.videoCategory);\n    },\n    //获取分类下的视频\n    // 这个接口一次只能获取8条数据, 所以我每次请求循环2次这个请求 拿16条数据\n    // 因为是每次8条数据push进去的 push了前 8条时因为高度不够，触发了组件video-list-card的触底，\n    // 又调用了一次请求，所以第一次请求会请求32条数据，后面高度够了都是一次请求16条，我觉得挺好的，就不理这个bug了\n    async getVideoList(id) {\n      let i = 2;\n      while (i) {\n        if (this.hasMore) {\n          let res = await this.$request(\"/video/group\", {\n            id,\n            offset: 8 * (this.videoPage - 1),\n          });\n          this.hasMore = res.data.hasmore;\n          this.videoList.push(...res.data.datas);\n          this.videoPage += 1;\n          i--;\n        } else {\n          return;\n        }\n      }\n      // console.log(this.videoList);\n    },\n\n    // 获取视频分类tag\n    async getSortList() {\n      let res = await this.$request(\"/video/group/list\");\n      // console.log(res);\n      // console.log(res.data.data);\n      this.sortList = res.data.data;\n    },\n\n    // 事件\n    // 点击分类的回调\n    clickSecondBarItem(index) {\n      // console.log(\"clickSecondBarItem\");\n      this.videoPage = 1;\n      this.videoList = [];\n      this.currentTag = this.videoCategory[index];\n      this.getVideoList(this.currentTag.id);\n    },\n    // 进入视频详情页面\n    goToVideoDetail({ id }) {\n      console.log(id);\n      this.$router.push({\n        name: \"videoDetail\",\n        params: { id, type: \"video\" },\n      });\n    },\n    // 上拉触底的回调\n    bottomLoad() {\n      // console.log(\"goToVideoDetail\");\n      if (this.hasMore) {\n        this.getVideoList(this.currentTag.id);\n      }\n    },\n\n    // 点击sortBoxItem的分类item的回调\n    clickSortBoxItem(item) {\n      this.currentTag = item;\n      this.videoPage = 1;\n      this.videoList = [];\n      this.getVideoList(item.id);\n    },\n  },\n  async created() {\n    await this.getVideoCategory();\n    await this.getVideoList(this.currentTag.id);\n  },\n};\n</script>\n\n<style scoped>\n.musicListNavBar {\n  padding: 10px 25px;\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n}\n\n.page {\n  width: 100%;\n  text-align: center;\n  padding-bottom: 20px;\n}\n\n.cardList {\n  overflow-y: scroll;\n  /* height: calc(100vh - 215px); */\n  height: calc(80vh - 215px);\n}\n</style>"]}]}