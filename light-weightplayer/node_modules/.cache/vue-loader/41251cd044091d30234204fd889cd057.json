{"remainingRequest":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\musicDetailCard\\MusicDetailCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\musicDetailCard\\MusicDetailCard.vue","mtime":1632135031000},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\babel-loader\\lib\\index.js","mtime":1636408357214},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb21tZW50IGZyb20gImNvbXBvbmVudHMvY29tbWVudC9Db21tZW50LnZ1ZSI7CmltcG9ydCBMeXJpY3NTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9seXJpY3NTY3JvbGwvTHlyaWNzU2Nyb2xsLnZ1ZSI7CmltcG9ydCBHb1RvcCBmcm9tICJjb21wb25lbnRzL2dvVG9wL0dvVG9wLnZ1ZSI7CgovLyDlrprml7blmajlkI3np7AKbGV0IHRpbWVyOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgTHlyaWNzU2Nyb2xsLCBDb21tZW50LCBHb1RvcCB9LAogIG5hbWU6ICJNdXNpY0RldGFpbENhcmQiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDmmK/lkKbmmL7npLrmrYzmm7Lor6bmg4XljaHniYcKICAgICAgaXNNdXNpY0RldGFpbENhcmRTaG93OiBmYWxzZSwKICAgICAgLy8gICDmrYzor40KICAgICAgbHlyaWM6IFtbMCwgIuato+WcqOWKoOi9veatjOivjSJdXSwKICAgICAgLy/lvZPliY3or4TorrrpobXmlbAKICAgICAgY3VycmVudENvbW1lbnRQYWdlOiAxLAogICAgICAvLyDor4TorrrmlbDmja4KICAgICAgY29tbWVudDoge30sCiAgICAgIC8vICAg5b2T5YmN5q2M5puy5L+h5oGvCiAgICAgIG11c2ljSW5mbzoge30sCiAgICAgIC8vIOaYr+WQpuWIoOmZpOWNoeeJh+a4suafk+eahOWGheWuuQogICAgICBjbGVhbkNhcmQ6IHRydWUsCiAgICAgIC8vIOiDjOaZr+aYvuekuuaooeW8jyAgdHJ1ZeS4uueZveiJsua4kOWPmOiDjOaZryAgZmFsc2XkuLrmr5vnjrvnkoPog4zmma8KICAgICAgYmFja2dyb3VuZE1vZGU6IHRydWUsCiAgICAgIC8vIOivhOiuuuaYr+WQpuWcqOWKoOi9veS4rQogICAgICBpc0NvbW1lbnRMb2FkaW5nOiBmYWxzZSwKICAgICAgLy8g54Ot6Zeo6K+E6K66CiAgICAgIGhvdENvbW1lbnRzOiBbXSwKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgIiRzdG9yZS5zdGF0ZS5pc011c2ljRGV0YWlsQ2FyZFNob3ciKGlzTXVzaWNEZXRhaWxDYXJkU2hvdykgewogICAgICB0aGlzLmlzTXVzaWNEZXRhaWxDYXJkU2hvdyA9IGlzTXVzaWNEZXRhaWxDYXJkU2hvdzsKICAgICAgLy8gICDmgKfog73kvJjljJYKICAgICAgLy/lpoLmnpzljaHniYfmsqHmnInlsZXnpLrlsLHkuI3lj5HpgIHor7fmsYLlkozmuLLmn5Pph4zpnaLnmoTlhoXlrrkKICAgICAgLy8gICDliKDpmaTlrprml7blmagg6YG/5YWN55So5oi35Zyo5YWz6Zet5Y2h54mH55qEMXPlhoXlj4jmiZPlvIDljaHniYcg5a+86Ie05bGV56S65YaF5a656KKr5Yig6ZmkCiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICAgIHRoaXMuY2xlYW5DYXJkID0gZmFsc2U7CiAgICAgIGlmICgKICAgICAgICBpc011c2ljRGV0YWlsQ2FyZFNob3cgJiYKICAgICAgICAhdGhpcy5jb21tZW50LmNvbW1lbnRzICYmCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUubXVzaWNJZCAhPSAiIgogICAgICApIHsKICAgICAgICBjb25zb2xlLmxvZygi6K+35rGC5q2M6K+N5ZKM6K+E6K66Iik7CiAgICAgICAgdGhpcy5nZXRMeXJpYyh0aGlzLiRzdG9yZS5zdGF0ZS5tdXNpY0lkKTsKICAgICAgICB0aGlzLmdldE11c2ljQ29tbWVudCh0aGlzLiRzdG9yZS5zdGF0ZS5tdXNpY0lkKTsKICAgICAgfQogICAgICAvLyAgIOW9k+WNoeeJh+WFs+mXreaXtiDlu7bov58gM3Plho3liKDpmaTph4zpnaLmuLLmn5PnmoTlhoXlrrkg5o+Q5Y2H5L2T6aqMCiAgICAgIGVsc2UgaWYgKGlzTXVzaWNEZXRhaWxDYXJkU2hvdyA9PSBmYWxzZSkgewogICAgICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLmNsZWFuQ2FyZCA9IHRydWU7CiAgICAgICAgfSwgMzAwMCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDlvZN2dWV45Lit55qE5q2M5puyaWTlj5HnlJ/lj5jljJbml7Ys6ZyA6KaB6YeN5paw6I635Y+W6K+E6K665ZKM5q2M6K+NCiAgICAiJHN0b3JlLnN0YXRlLm11c2ljSWQiKG11c2ljSWQpIHsKICAgICAgLy8g5riF56m65q2M6K+NCiAgICAgIHRoaXMubHlyaWMgPSBbWzAsICLmraPlnKjliqDovb3mrYzor40iXV07CiAgICAgIC8vIOmHjee9ruivhOiuuumhteaVsAogICAgICB0aGlzLmN1cnJlbnRDb21tZW50UGFnZSA9IDE7CiAgICAgIC8vIOabtOaWsOW9k+WJjeatjOabsuS/oeaBrwogICAgICB0aGlzLm11c2ljSW5mbyA9CiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUubXVzaWNMaXN0W3RoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRJbmRleF07CiAgICAgIHRoaXMuY29tbWVudCA9IHt9OwogICAgICAvLyDkvJjljJbmgKfog70s5LuF5Zyo5Y2h54mH5bGV56S65pe25omN5Y+R6YCB6K+35rGCCiAgICAgIGlmICh0aGlzLmlzTXVzaWNEZXRhaWxDYXJkU2hvdykgewogICAgICAgIHRoaXMuZ2V0THlyaWMobXVzaWNJZCk7CiAgICAgICAgdGhpcy5nZXRNdXNpY0NvbW1lbnQobXVzaWNJZCk7CiAgICAgIH0KICAgICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLm11c2ljSW5mbyk7CiAgICAgIC8vICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5kaXNjKTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDor7fmsYIKICAgIC8v6K+35rGC5bm25aSE55CG5q2M6K+N5pWw5o2uCiAgICBhc3luYyBnZXRMeXJpYyhpZCkgewogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kcmVxdWVzdCgiL2x5cmljIiwgeyBpZCB9KTsKICAgICAgLy8gICBjb25zb2xlLmxvZyhyZXMpOwogICAgICBsZXQgbHlyaWNzID0gcmVzLmRhdGEubHJjLmx5cmljOwogICAgICAvLyDlr7nojrflj5bliLDnmoTmrYzor43ov5vooYzlpITnkIYKICAgICAgbGV0IGFyciA9IGx5cmljcy5zcGxpdCgiXG4iKTsKICAgICAgbGV0IGFycmF5ID0gW107CiAgICAgIC8vIGxldCBvYmogPSB7fTsKICAgICAgbGV0IHRpbWUgPSAiIjsKICAgICAgbGV0IHZhbHVlID0gIiI7CiAgICAgIGxldCByZXN1bHQgPSBbXTsKCiAgICAgIC8v5Y676Zmk56m66KGMCiAgICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgaWYgKGl0ZW0gIT0gIiIpIHsKICAgICAgICAgIGFycmF5LnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgYXJyID0gYXJyYXk7CiAgICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgdGltZSA9IGl0ZW0uc3BsaXQoIl0iKVswXTsKICAgICAgICB2YWx1ZSA9IGl0ZW0uc3BsaXQoIl0iKVsxXTsKICAgICAgICAvL+WOu+aOieaXtumXtOmHjOeahOS4reaLrOWPt+W+l+WIsHh4Onh4Lnh4CiAgICAgICAgdmFyIHQgPSB0aW1lLnNsaWNlKDEpLnNwbGl0KCI6Iik7CiAgICAgICAgLy/lsIbnu5PmnpzljovlhaXmnIDnu4jmlbDnu4QKICAgICAgICByZXN1bHQucHVzaChbcGFyc2VJbnQodFswXSwgMTApICogNjAgKyBwYXJzZUZsb2F0KHRbMV0pLCB2YWx1ZV0pOwogICAgICB9KTsKCiAgICAgIHRoaXMubHlyaWMgPSByZXN1bHQ7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMubHlyaWMpOwogICAgfSwKICAgIC8vIOivt+axguivhOiuuuaVsOaNrgogICAgYXN5bmMgZ2V0TXVzaWNDb21tZW50KGlkLCB0eXBlKSB7CiAgICAgIC8vIOiOt+WPluaXtumXtOaIswogICAgICB2YXIgdGltZXN0YW1wID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTsKCiAgICAgIHRoaXMuaXNDb21tZW50TG9hZGluZyA9IHRydWU7CiAgICAgIGlmICh0eXBlID09ICJjaGFuZ2VQYWdlIikgewogICAgICAgIGxldCBtdXNpY0RldGFpbENhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKAogICAgICAgICAgIi5tdXNpY0RldGFpbENhcmRDb250YWluZXIiCiAgICAgICAgKTsKICAgICAgICBsZXQgdG9wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnRvcCIpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKFttdXNpY0RldGFpbENhcmRDb250YWluZXIsIHRvcF0pOwogICAgICAgIG11c2ljRGV0YWlsQ2FyZENvbnRhaW5lci5zY3JvbGxUbyh7CiAgICAgICAgICBiZWhhdmlvcjogInNtb290aCIsCiAgICAgICAgICB0b3A6IHRvcC5jbGllbnRIZWlnaHQsCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIC8vIOW9k+mhteaVsOS4uuesrOS4gOmhteaXtu+8jOivt+axgjEw5p2h54Ot6Zeo5pWw5o2uCiAgICAgIGlmICh0aGlzLmN1cnJlbnRDb21tZW50UGFnZSA9PSAxKSB7CiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuJHJlcXVlc3QoIi9jb21tZW50L2hvdCIsIHsKICAgICAgICAgIGlkLAogICAgICAgICAgbGltaXQ6IDEwLAogICAgICAgICAgdHlwZTogMCwKICAgICAgICAgIHRpbWVzdGFtcCwKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlICE9IDIwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6I635Y+W54Ot6Zeo6K+E6K665aSx6LSlLOivt+eojeWQjumHjeivlSEiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5ob3RDb21tZW50cyA9IHJlcy5kYXRhLmhvdENvbW1lbnRzOwogICAgICB9CgogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kcmVxdWVzdCgiL2NvbW1lbnQvbXVzaWMiLCB7CiAgICAgICAgaWQsCiAgICAgICAgb2Zmc2V0OiAodGhpcy5jdXJyZW50Q29tbWVudFBhZ2UgLSAxKSAqIDIwLAogICAgICAgIHRpbWVzdGFtcCwKICAgICAgfSk7CgogICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICBpZiAocmVzLmRhdGEuY29kZSAhPT0gMjAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6I635Y+W6K+E6K665aSx6LSlLOivt+eojeWQjumHjeivlSEiKTsKICAgICAgfQoKICAgICAgdGhpcy5pc0NvbW1lbnRMb2FkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuY29tbWVudCA9IHJlcy5kYXRhOwogICAgfSwKICAgIC8v54K55Ye75YiG6aG15oyJ6ZKu55qE5Zue6LCDCiAgICBjb21tZW50UGFnZUNoYW5nZShwYWdlKSB7CiAgICAgIHRoaXMuY3VycmVudENvbW1lbnRQYWdlID0gcGFnZTsKICAgICAgdGhpcy5nZXRNdXNpY0NvbW1lbnQodGhpcy4kc3RvcmUuc3RhdGUubXVzaWNJZCwgImNoYW5nZVBhZ2UiKTsKICAgIH0sCiAgICAvLyDngrnlh7vlhbPpl63ljaHniYfnmoTlm57osIMKICAgIGNsb3NlQ2FyZCgpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJjaGFuZ2VNdXNpY0RldGFpbENhcmRTdGF0ZSIpOwogICAgfSwKICAgIC8vIOeCueWHu+WIh+aNouiDjOaZr+eahOWbnuiwgwogICAgY2hhbmdlQmFja2dyb3VuZCgpIHsKICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiRmlyZWZveCIpICE9IC0xKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coImZmIik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKAogICAgICAgICAgIueBq+eLkOaaguS4jeaUr+aMgeeOu+eSg+iDjOaZr+WKn+iDve+8jOivt+S9v+eUqENocm9tZeaIlkVkZ2XmtY/op4jlmagiCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5iYWNrZ3JvdW5kTW9kZSA9ICF0aGlzLmJhY2tncm91bmRNb2RlOwogICAgfSwKCiAgICAvLyDngrnlh7vot7Povazoh7Plr7nlupTnmoTor6bmg4XpobXpnaIKICAgIGdvVG9EZXRhaWxQYWdlKG5hbWUsIGlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZSwgcGFyYW1zOiB7IGlkIH0gfSk7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2hhbmdlTXVzaWNEZXRhaWxDYXJkU3RhdGUiLCBmYWxzZSk7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHt9LAp9Owo="},{"version":3,"sources":["MusicDetailCard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MusicDetailCard.vue","sourceRoot":"src/views/musicDetailCard","sourcesContent":["<template>\n  <div\n    class=\"musicDetailCard\"\n    :class=\"[\n      isMusicDetailCardShow ? '' : 'hide',\n      backgroundMode ? '' : 'glassCard',\n    ]\"\n  >\n    <div class=\"closeCard\" @click=\"closeCard\">\n      <i class=\"iconfont icon-arrow-down-bold\"></i>\n    </div>\n    <div class=\"changeBackground\" @click=\"changeBackground\">\n      <i class=\"iconfont icon-UniSetBackgroundTextStyle\"></i>\n    </div>\n    <div class=\"musicDetailCardContainer\" v-if=\"!cleanCard && musicInfo.name\">\n      <div class=\"top\">\n        <div class=\"left\">\n          <div class=\"discContainer\">\n            <div\n              class=\"needle\"\n              :class=\"$store.state.isPlay ? 'needleRotate' : ''\"\n              ref=\"needle\"\n            >\n              <img src=\"~assets/img/MusicDetailCard/needle.png\" alt=\"\" />\n            </div>\n            <!-- 通过音乐的加载时差删除discAnimation类名再添加,达到重置动画的效果 -->\n            <div\n              class=\"disc\"\n              :class=\"[\n                $store.state.isPlay ? '' : 'pause',\n                $store.state.isMusicLoad ? '' : 'discAnimation',\n              ]\"\n              ref=\"disc\"\n            >\n              <img src=\"~assets/img/MusicDetailCard/disc.png\" alt=\"\" />\n              <img\n                src=\"~assets/img/test.jpg\"\n                alt=\"\"\n                class=\"musicAvatar\"\n                v-if=\"!musicInfo.al\"\n              />\n              <img\n                :src=\"musicInfo.al.picUrl\"\n                alt=\"\"\n                class=\"musicAvatar\"\n                v-else\n              />\n            </div>\n          </div>\n        </div>\n        <div class=\"right\">\n          <div class=\"title\">\n            <div class=\"musicName\">{{ musicInfo.name }}</div>\n            <div\n              class=\"album\"\n              @click=\"goToDetailPage('album', musicInfo.al.id)\"\n            >\n              {{ musicInfo.al.name }}\n            </div>\n            <div\n              class=\"singer\"\n              @click=\"goToDetailPage('singerDetail', musicInfo.ar[0].id)\"\n            >\n              {{ musicInfo.ar[0].name }}\n            </div>\n          </div>\n          <lyrics-scroll :lyric=\"lyric\"></lyrics-scroll>\n        </div>\n      </div>\n      <div\n        class=\"bottom\"\n        v-loading=\"isCommentLoading\"\n        element-loading-background=\"rgba(255, 255, 255, 0.1)\"\n      >\n        <comment\n          :comments=\"hotComments\"\n          :commentType=\"'music'\"\n          :commentId=\"$store.state.musicId + ''\"\n          :musicTitle=\"musicInfo.name\"\n          @getComment=\"getMusicComment($store.state.musicId)\"\n          class=\"commentComponent\"\n          v-if=\"currentCommentPage == 1\"\n          ><div slot=\"title\">热门评论</div></comment\n        >\n        <comment\n          :comments=\"comment.comments\"\n          :commentType=\"'music'\"\n          :commentId=\"$store.state.musicId + ''\"\n          :musicTitle=\"musicInfo.name\"\n          @getComment=\"getMusicComment($store.state.musicId)\"\n          class=\"commentComponent\"\n          ><div slot=\"title\">最新评论({{ comment.total }})</div></comment\n        >\n        <!-- 评论分页 -->\n        <div class=\"page\" v-show=\"comment.comments && comment.comments[0]\">\n          <el-pagination\n            background\n            layout=\"prev, pager, next\"\n            :total=\"comment.total\"\n            small\n            :page-size=\"20\"\n            :current-page=\"currentCommentPage\"\n            @current-change=\"commentPageChange\"\n          >\n          </el-pagination>\n        </div>\n      </div>\n      <go-top scrollObj=\".musicDetailCardContainer\"></go-top>\n    </div>\n    <div v-else class=\"tip\">暂无播放音乐</div>\n  </div>\n</template>\n\n<script>\nimport Comment from \"components/comment/Comment.vue\";\nimport LyricsScroll from \"components/lyricsScroll/LyricsScroll.vue\";\nimport GoTop from \"components/goTop/GoTop.vue\";\n\n// 定时器名称\nlet timer;\n\nexport default {\n  components: { LyricsScroll, Comment, GoTop },\n  name: \"MusicDetailCard\",\n  data() {\n    return {\n      // 是否显示歌曲详情卡片\n      isMusicDetailCardShow: false,\n      //   歌词\n      lyric: [[0, \"正在加载歌词\"]],\n      //当前评论页数\n      currentCommentPage: 1,\n      // 评论数据\n      comment: {},\n      //   当前歌曲信息\n      musicInfo: {},\n      // 是否删除卡片渲染的内容\n      cleanCard: true,\n      // 背景显示模式  true为白色渐变背景  false为毛玻璃背景\n      backgroundMode: true,\n      // 评论是否在加载中\n      isCommentLoading: false,\n      // 热门评论\n      hotComments: [],\n    };\n  },\n  watch: {\n    \"$store.state.isMusicDetailCardShow\"(isMusicDetailCardShow) {\n      this.isMusicDetailCardShow = isMusicDetailCardShow;\n      //   性能优化\n      //如果卡片没有展示就不发送请求和渲染里面的内容\n      //   删除定时器 避免用户在关闭卡片的1s内又打开卡片 导致展示内容被删除\n      clearTimeout(timer);\n      this.cleanCard = false;\n      if (\n        isMusicDetailCardShow &&\n        !this.comment.comments &&\n        this.$store.state.musicId != \"\"\n      ) {\n        console.log(\"请求歌词和评论\");\n        this.getLyric(this.$store.state.musicId);\n        this.getMusicComment(this.$store.state.musicId);\n      }\n      //   当卡片关闭时 延迟 3s再删除里面渲染的内容 提升体验\n      else if (isMusicDetailCardShow == false) {\n        timer = setTimeout(() => {\n          this.cleanCard = true;\n        }, 3000);\n      }\n    },\n    // 当vuex中的歌曲id发生变化时,需要重新获取评论和歌词\n    \"$store.state.musicId\"(musicId) {\n      // 清空歌词\n      this.lyric = [[0, \"正在加载歌词\"]];\n      // 重置评论页数\n      this.currentCommentPage = 1;\n      // 更新当前歌曲信息\n      this.musicInfo =\n        this.$store.state.musicList[this.$store.state.currentIndex];\n      this.comment = {};\n      // 优化性能,仅在卡片展示时才发送请求\n      if (this.isMusicDetailCardShow) {\n        this.getLyric(musicId);\n        this.getMusicComment(musicId);\n      }\n      //   console.log(this.musicInfo);\n      //   console.log(this.$refs.disc);\n    },\n  },\n  methods: {\n    // 请求\n    //请求并处理歌词数据\n    async getLyric(id) {\n      let res = await this.$request(\"/lyric\", { id });\n      //   console.log(res);\n      let lyrics = res.data.lrc.lyric;\n      // 对获取到的歌词进行处理\n      let arr = lyrics.split(\"\\n\");\n      let array = [];\n      // let obj = {};\n      let time = \"\";\n      let value = \"\";\n      let result = [];\n\n      //去除空行\n      arr.forEach((item) => {\n        if (item != \"\") {\n          array.push(item);\n        }\n      });\n      arr = array;\n      arr.forEach((item) => {\n        time = item.split(\"]\")[0];\n        value = item.split(\"]\")[1];\n        //去掉时间里的中括号得到xx:xx.xx\n        var t = time.slice(1).split(\":\");\n        //将结果压入最终数组\n        result.push([parseInt(t[0], 10) * 60 + parseFloat(t[1]), value]);\n      });\n\n      this.lyric = result;\n      // console.log(this.lyric);\n    },\n    // 请求评论数据\n    async getMusicComment(id, type) {\n      // 获取时间戳\n      var timestamp = Date.parse(new Date());\n\n      this.isCommentLoading = true;\n      if (type == \"changePage\") {\n        let musicDetailCardContainer = document.querySelector(\n          \".musicDetailCardContainer\"\n        );\n        let top = document.querySelector(\".top\");\n        // console.log([musicDetailCardContainer, top]);\n        musicDetailCardContainer.scrollTo({\n          behavior: \"smooth\",\n          top: top.clientHeight,\n        });\n      }\n\n      // 当页数为第一页时，请求10条热门数据\n      if (this.currentCommentPage == 1) {\n        let res = await this.$request(\"/comment/hot\", {\n          id,\n          limit: 10,\n          type: 0,\n          timestamp,\n        });\n        console.log(res);\n        if (res.data.code != 200) {\n          this.$message.error(\"获取热门评论失败,请稍后重试!\");\n          return;\n        }\n        this.hotComments = res.data.hotComments;\n      }\n\n      let res = await this.$request(\"/comment/music\", {\n        id,\n        offset: (this.currentCommentPage - 1) * 20,\n        timestamp,\n      });\n\n      console.log(res);\n      if (res.data.code !== 200) {\n        this.$message.error(\"获取评论失败,请稍后重试!\");\n      }\n\n      this.isCommentLoading = false;\n      this.comment = res.data;\n    },\n    //点击分页按钮的回调\n    commentPageChange(page) {\n      this.currentCommentPage = page;\n      this.getMusicComment(this.$store.state.musicId, \"changePage\");\n    },\n    // 点击关闭卡片的回调\n    closeCard() {\n      this.$store.commit(\"changeMusicDetailCardState\");\n    },\n    // 点击切换背景的回调\n    changeBackground() {\n      if (navigator.userAgent.indexOf(\"Firefox\") != -1) {\n        // console.log(\"ff\");\n        this.$message.info(\n          \"火狐暂不支持玻璃背景功能，请使用Chrome或Edge浏览器\"\n        );\n        return;\n      }\n      this.backgroundMode = !this.backgroundMode;\n    },\n\n    // 点击跳转至对应的详情页面\n    goToDetailPage(name, id) {\n      this.$router.push({ name, params: { id } });\n      this.$store.commit(\"changeMusicDetailCardState\", false);\n    },\n  },\n  created() {},\n};\n</script>\n\n<style scoped lang=\"less\">\n.glassCard {\n  // 火狐默认不支持backdrop-filter 可以手动激活，这里不折腾了，火狐关闭玻璃背景功能，反正这个功能特别吃性能，字体也看不清了，没必要\n  backdrop-filter: blur(50px) brightness(95%) !important;\n  background-color: unset !important;\n  background-image: unset !important;\n  * {\n    color: rgb(37, 37, 37);\n\n    .commentComponent /deep/ * {\n      color: rgb(37, 37, 37);\n      border-color: rgb(143, 143, 143);\n\n      .replied {\n        border-radius: 5px;\n        background-color: rgba(0, 0, 0, 0.1);\n      }\n    }\n  }\n}\n\n.musicDetailCard {\n  position: fixed;\n  width: 100%;\n  // height: calc(100vh - 55px);\n  height: calc(80vh - 55px);\n  bottom: 55px;\n  left: 0;\n  z-index: 1000;\n  transition: bottom 0.5s ease;\n  background-color: white;\n  background-image: linear-gradient(to bottom, #e3e2e3, white);\n}\n\n.closeCard .iconfont {\n  position: absolute;\n  top: 15px;\n  left: 35px;\n  font-size: 21px !important;\n}\n\n.musicDetailCardContainer {\n  height: 100%;\n  overflow-y: scroll;\n}\n\n.hide {\n  // bottom: calc(-100vh + 55px);\n  bottom: calc(-80vh + 55px);\n  // transform不会引发重流 性能更好 但是这里如果使用transform 在resize时会出现musicDetailCard拖影的情况，是transition引发的，\n  // 可能可以通过animation代替transtion解决，不太确定，没有尝试过，但是使用transform还需另外禁止index页面滚动，\n  // 所以我这里还是选择使用固定定位 性能稍差，但是由于脱离的文档流，也不会差很远\n  // transform: translateY(calc(80vh - 55px));\n}\n\n.top {\n  display: flex;\n  justify-content: center;\n}\n\n.left {\n  width: 220px;\n  margin: 0 30px 0 -40px;\n}\n\n.discContainer {\n  margin-top: 60px;\n  width: 220px;\n  position: relative;\n}\n\n.needle {\n  position: relative;\n  left: 50%;\n  width: 88px;\n  height: 72px;\n  z-index: 10000;\n  transition: all 1s;\n  transform-origin: 5.3px 5.3px;\n}\n\n.needle img {\n  width: 100%;\n}\n\n.needleRotate {\n  transform-origin: 5.3px 5.3px;\n  transform: rotate(22deg);\n}\n\n.disc {\n  width: 220px;\n  height: 220px;\n  position: relative;\n  top: -12px;\n}\n\n.disc img:nth-child(1) {\n  width: 100%;\n}\n\n.disc .musicAvatar {\n  position: absolute;\n  top: 35px;\n  left: 35px;\n  width: 150px;\n  z-index: -1;\n}\n\n/* 碟子设置旋转动画 */\n.discAnimation {\n  /* infinite动画无限循环 */\n  animation: disc 25s linear infinite;\n  /* 动画延迟一秒 */\n  animation-delay: 0.8s;\n}\n\n@keyframes disc {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.pause {\n  animation-play-state: paused;\n  -webkit-animation-play-state: paused;\n}\n\n.right {\n  width: 350px;\n}\n\n.title {\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n  margin: 30px 0 15px;\n  color: rgb(145, 145, 145);\n}\n\n.title div {\n  margin: 7px 0;\n}\n\n.musicName {\n  font-size: 23px;\n  color: rgb(22, 22, 22);\n}\n\n.bottom {\n  margin: 40px auto;\n  // width: 55vw;\n  width: 44vw;\n}\n\n.page {\n  width: 100%;\n  text-align: center;\n  padding-bottom: 20px;\n}\n\n.tip {\n  font-size: 20px;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n}\n\n.changeBackground {\n  position: absolute;\n  bottom: 10px;\n  right: 20px;\n  cursor: pointer;\n}\n\n.bottom /deep/ .el-loading-spinner {\n  top: 40px;\n}\n\n.album,\n.singer {\n  cursor: pointer;\n}\n</style>\n"]}]}