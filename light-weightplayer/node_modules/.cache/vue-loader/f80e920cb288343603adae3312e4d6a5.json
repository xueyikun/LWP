{"remainingRequest":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GH\\LWP\\light-weightplayer\\src\\components\\Index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GH\\LWP\\light-weightplayer\\src\\components\\Index.vue","mtime":1636482270761},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\babel-loader\\lib\\index.js","mtime":1636408357214},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgppbXBvcnQgQm90dG9tQ29udHJvbCBmcm9tICJjb21wb25lbnRzL2JvdHRvbUNvbnRyb2wvQm90dG9tQ29udHJvbCI7CmltcG9ydCBIZWFkZXJCYXIgZnJvbSAiY29tcG9uZW50cy9oZWFkZXJCYXIvSGVhZGVyQmFyLnZ1ZSI7CmltcG9ydCBNdXNpY0RldGFpbENhcmQgZnJvbSAidmlld3MvbXVzaWNEZXRhaWxDYXJkL011c2ljRGV0YWlsQ2FyZC52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQm90dG9tQ29udHJvbCwKICAgIEhlYWRlckJhciwKICAgIE11c2ljRGV0YWlsQ2FyZCwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkZWZhdWx0QWN0aXZlOiAiIiwKICAgICAgLy8g55So5oi35L+h5oGvCiAgICAgIC8vIHVzZXJJbmZvOiB7fSwKICAgICAgLy8g5Yib5bu655qE5q2M5Y2VCiAgICAgIGNyZWF0ZWRNdXNpY0xpc3Q6IFtdLAogICAgICAvLyDmlLbol4/nmoTmrYzljZUKICAgICAgY29sbGVjdGVkTXVzaWNMaXN0OiBbXSwKICAgICAgLy8g5LiL6L2955qE6Z+z5LmQ55qE5L+h5oGvCiAgICAgIGRvd25sb2FkTXVzaWNJbmZvOiB7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdXJsOiAiIiwKICAgICAgfSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuJHJvdXRlLnBhdGguc2VhcmNoKCIvbXVzaWNsaXN0ZGV0YWlsIikgPT0gLTEpIHsKICAgICAgdGhpcy5kZWZhdWx0QWN0aXZlID0gIi8iICsgdGhpcy4kcm91dGUucGF0aC5zcGxpdCgiLyIpWzFdOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5kZWZhdWx0QWN0aXZlID0gdGhpcy4kcm91dGUucGF0aDsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOivt+axggogICAgLy8g6K+35rGC55So5oi35q2M5Y2VCiAgICBhc3luYyBnZXRVc2VyTXVzaWNMaXN0KCkgewogICAgICBpZiAoIXRoaXMuJHN0b3JlLnN0YXRlLmlzTG9naW4pIHsKICAgICAgICAvLyDor7TmmI7lt7Lnu4/pgIDlh7rnmbvlvZUKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7flhYjov5vooYznmbvlvZXmk43kvZwiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IHRpbWVzdGFtcCA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7CiAgICAgIC8vIOWFiOS7jmxvY2FsU3RvcmFnZemHjOmdouivu+WPlueUqOaIt+S/oeaBryAg5aaC5p6c55m75b2V5oiQ5Yqf5piv5pyJ5a2Y55qECiAgICAgIC8vIHRoaXMudXNlckluZm8gPQogICAgICAvLyAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlckluZm8iKSAmJgogICAgICAvLyAgIEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKTsKCiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRyZXF1ZXN0KCIvdXNlci9wbGF5bGlzdCIsIHsKICAgICAgICB1aWQ6IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIiksCiAgICAgICAgdGltZXN0YW1wLAogICAgICB9KTsKICAgICAgLy8gY29uc29sZS5sb2cocmVzKTsKICAgICAgLy8g5a+55pWw5o2u6L+b6KGM5aSE55CG5YiG57G7CiAgICAgIHJlcyA9IHJlcy5kYXRhLnBsYXlsaXN0OwogICAgICBsZXQgaW5kZXggPSByZXMuZmluZEluZGV4KChpdGVtKSA9PiBpdGVtLnN1YnNjcmliZWQgPT0gdHJ1ZSk7CiAgICAgIHRoaXMuY3JlYXRlZE11c2ljTGlzdCA9IHJlcy5zbGljZSgwLCBpbmRleCk7CiAgICAgIHRoaXMuY29sbGVjdGVkTXVzaWNMaXN0ID0gcmVzLnNsaWNlKGluZGV4KTsKICAgICAgdGhpcy5jcmVhdGVkTXVzaWNMaXN0WzBdLm5hbWUgPSAi5oiR5Zac5qyi55qE6Z+z5LmQIjsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jcmVhdGVkTXVzaWNMaXN0LCB0aGlzLmNvbGxlY3RlZE11c2ljTGlzdCk7CiAgICAgIC8vIOWwhuaUtuiXj+eahOatjOWNleS4iuS8oOiHs3Z1ZXgKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJ1cGRhdGVDb2xsZWN0TXVzaWNMaXN0IiwgdGhpcy5jb2xsZWN0ZWRNdXNpY0xpc3QpOwogICAgICAvLyDlsIbliJvlu7rnmoTmrYzljZXkuIrkvKDoh7N2dWV4CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRlQ3JlYXRlZE11c2ljTGlzdCIsIHRoaXMuY3JlYXRlZE11c2ljTGlzdCk7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIAogICAgLy8g55uR5ZCs5pS26JeP5q2M5Y2V55qE5Y+Y5YyWCiAgICAiJHN0b3JlLnN0YXRlLmNvbGxlY3RNdXNpY0xpc3QiKGN1cnJlbnQpIHsKICAgICAgdGhpcy5jb2xsZWN0ZWRNdXNpY0xpc3QgPSBjdXJyZW50OwogICAgfSwKICAgICIkcm91dGUucGF0aCIoY3VycmVudCkgewogICAgICAvLyDlj5bot6/nlLHkuK3nmoTpppblnLDlnYAg55So5LqO5L6n6L655qCP55qE5a+86IiqYWN0aXZlCiAgICAgIGlmIChjdXJyZW50LnNlYXJjaCgiL211c2ljbGlzdGRldGFpbCIpID09IC0xKSB7CiAgICAgICAgdGhpcy5kZWZhdWx0QWN0aXZlID0gIi8iICsgY3VycmVudC5zcGxpdCgiLyIpWzFdOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZGVmYXVsdEFjdGl2ZSA9IGN1cnJlbnQ7CiAgICAgIH0KICAgIH0sCgogICAgLy8g55uR5ZCs5b2T5YmN5LiL6L296Z+z5LmQ5L+h5oGvCiAgICAiJHN0b3JlLnN0YXRlLmRvd25sb2FkTXVzaWNJbmZvIihjdXJyZW50KSB7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldChjdXJyZW50LnVybCwgeyByZXNwb25zZVR5cGU6ICJibG9iIiB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGxldCBibG9iID0gcmVzLmRhdGE7CiAgICAgICAgICBsZXQgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHVybCk7CiAgICAgICAgICBsZXQgYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNkb3dubG9hZEN1cnJlbnRNdXNpYyIpOwogICAgICAgICAgdGhpcy5kb3dubG9hZE11c2ljSW5mby51cmwgPSB1cmw7CiAgICAgICAgICB0aGlzLmRvd25sb2FkTXVzaWNJbmZvLm5hbWUgPSBjdXJyZW50Lm5hbWU7CiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIGEuY2xpY2soKTsKICAgICAgICAgICAgLy8g55So5a6M6YeK5pS+VVJM5a+56LGhCiAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIvovb3lpLHotKUs6K+356iN5ZCO6YeN6K+VISIpOwogICAgICAgIH0pOwoKICAgIH0sCiAgICAvLyDnm5HlkKx2dWV45Lit55qE55m75b2V54q25oCBCiAgICAiJHN0b3JlLnN0YXRlLmlzTG9naW4iKGN1cnJlbnQpIHsKICAgICAgLy8gY29uc29sZS5sb2coY3VycmVudCk7CiAgICAgIGlmIChjdXJyZW50KSB7CiAgICAgICAgdGhpcy5nZXRVc2VyTXVzaWNMaXN0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5riF56m65pS26JeP5ZKM5Yib5bu65q2M5Y2VCiAgICAgICAgdGhpcy5jcmVhdGVkTXVzaWNMaXN0ID0gW107CiAgICAgICAgdGhpcy5jb2xsZWN0ZWRNdXNpY0xpc3QgPSBbXTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Index.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-container>\n    <el-header>\n      <header-bar></header-bar>\n    </el-header>\n    <el-container>\n      <!-- 侧边栏 -->\n      <el-aside width=\"160px\">\n        <el-menu\n          active-text-color=\"black\"\n          router\n          :default-active=\"defaultActive\"\n        >\n          <el-menu-item index=\"/discover\">\n            <i class=\"iconfont icon-yinle\"></i>\n            <span slot=\"title\">音乐发现</span>\n          </el-menu-item>\n          <el-menu-item index=\"/video\">\n            <i class=\"iconfont icon-shipin\"></i>\n            <span slot=\"title\">视频</span>\n          </el-menu-item>\n          <el-menu-item index=\"/favorites\">\n            <i class=\"iconfont icon-more\"></i>\n            <span slot=\"title\">歌曲收藏</span>\n          </el-menu-item>\n          <el-menu-item index=\"/recommendmusic\">\n            <i class=\"iconfont icon-good\"></i>\n            <span slot=\"title\">每日推荐歌曲</span>\n          </el-menu-item>\n          <el-menu-item-group v-if=\"createdMusicList.length != 0\">\n            <template slot=\"title\" class=\"groupTitle\">创建的歌单</template>\n            <el-menu-item\n              v-for=\"(item, index) in createdMusicList\"\n              :key=\"index\"\n              :index=\"'/musiclistdetail/' + item.id\"\n            >\n              <i class=\"iconfont icon-gedan\"></i>{{ item.name }}</el-menu-item\n            >\n          </el-menu-item-group>\n\n          <el-menu-item-group v-if=\"collectedMusicList.length != 0\">\n            <template slot=\"title\" class=\"groupTitle\">收藏的歌单</template>\n            <el-menu-item\n              v-for=\"(item, index) in collectedMusicList\"\n              :key=\"index\"\n              :index=\"'/musiclistdetail/' + item.id\"\n            >\n              <i class=\"iconfont icon-gedan\"></i>{{ item.name }}</el-menu-item\n            >\n          </el-menu-item-group>\n        </el-menu>\n      </el-aside>\n      <!-- 主体内容 -->\n      <el-main>\n        <!-- 给router-view添加key有可能对性能有一定的损耗，\n        但是可以解决push同一个地址不同参数时不会重新渲染router-view的问题 -->\n        <router-view class=\"routerView\" :key=\"$route.fullPath\"></router-view>\n        <!-- 用于下载的a标签 -->\n        <a\n          :href=\"downloadMusicInfo.url\"\n          :download=\"downloadMusicInfo.name\"\n          target=\"_blank\"\n          id=\"downloadCurrentMusic\"\n        ></a>\n      </el-main>\n    </el-container>\n    <bottom-control></bottom-control>\n    <music-detail-card class=\"musicDetailCard\"></music-detail-card>\n  </el-container>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nimport BottomControl from \"components/bottomControl/BottomControl\";\nimport HeaderBar from \"components/headerBar/HeaderBar.vue\";\nimport MusicDetailCard from \"views/musicDetailCard/MusicDetailCard.vue\";\nexport default {\n  components: {\n    BottomControl,\n    HeaderBar,\n    MusicDetailCard,\n  },\n  data() {\n    return {\n      defaultActive: \"\",\n      // 用户信息\n      // userInfo: {},\n      // 创建的歌单\n      createdMusicList: [],\n      // 收藏的歌单\n      collectedMusicList: [],\n      // 下载的音乐的信息\n      downloadMusicInfo: {\n        name: \"\",\n        url: \"\",\n      },\n    };\n  },\n  created() {\n    if (this.$route.path.search(\"/musiclistdetail\") == -1) {\n      this.defaultActive = \"/\" + this.$route.path.split(\"/\")[1];\n    } else {\n      this.defaultActive = this.$route.path;\n    }\n  },\n  methods: {\n    // 请求\n    // 请求用户歌单\n    async getUserMusicList() {\n      if (!this.$store.state.isLogin) {\n        // 说明已经退出登录\n        this.$message.error(\"请先进行登录操作\");\n        return;\n      }\n      let timestamp = Date.parse(new Date());\n      // 先从localStorage里面读取用户信息  如果登录成功是有存的\n      // this.userInfo =\n      //   window.localStorage.getItem(\"userInfo\") &&\n      //   JSON.parse(window.localStorage.getItem(\"userInfo\"));\n\n      let res = await this.$request(\"/user/playlist\", {\n        uid: window.localStorage.getItem(\"userId\"),\n        timestamp,\n      });\n      // console.log(res);\n      // 对数据进行处理分类\n      res = res.data.playlist;\n      let index = res.findIndex((item) => item.subscribed == true);\n      this.createdMusicList = res.slice(0, index);\n      this.collectedMusicList = res.slice(index);\n      this.createdMusicList[0].name = \"我喜欢的音乐\";\n      // console.log(this.createdMusicList, this.collectedMusicList);\n      // 将收藏的歌单上传至vuex\n      this.$store.commit(\"updateCollectMusicList\", this.collectedMusicList);\n      // 将创建的歌单上传至vuex\n      this.$store.commit(\"updateCreatedMusicList\", this.createdMusicList);\n    },\n  },\n  watch: {\n    \n    // 监听收藏歌单的变化\n    \"$store.state.collectMusicList\"(current) {\n      this.collectedMusicList = current;\n    },\n    \"$route.path\"(current) {\n      // 取路由中的首地址 用于侧边栏的导航active\n      if (current.search(\"/musiclistdetail\") == -1) {\n        this.defaultActive = \"/\" + current.split(\"/\")[1];\n      } else {\n        this.defaultActive = current;\n      }\n    },\n\n    // 监听当前下载音乐信息\n    \"$store.state.downloadMusicInfo\"(current) {\n      axios\n        .get(current.url, { responseType: \"blob\" })\n        .then((res) => {\n          let blob = res.data;\n          let url = URL.createObjectURL(blob);\n          // console.log(url);\n          let a = document.querySelector(\"#downloadCurrentMusic\");\n          this.downloadMusicInfo.url = url;\n          this.downloadMusicInfo.name = current.name;\n          this.$nextTick(() => {\n            a.click();\n            // 用完释放URL对象\n            URL.revokeObjectURL(url);\n          });\n        })\n        .catch((err) => {\n          console.log(err);\n          this.$message.error(\"下载失败,请稍后重试!\");\n        });\n\n    },\n    // 监听vuex中的登录状态\n    \"$store.state.isLogin\"(current) {\n      // console.log(current);\n      if (current) {\n        this.getUserMusicList();\n      } else {\n        // 清空收藏和创建歌单\n        this.createdMusicList = [];\n        this.collectedMusicList = [];\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.is-active {\n  background-color: #f6f6f7;\n  font-size: 14px;\n  font-weight: 600;\n}\n\n.iconfont {\n  font-size: 14px;\n  margin: 5px !important;\n}\n\n.routerView {\n  padding: 0 15px;\n  margin: 0;\n  width: 100%;\n  height: calc(80vh - 105px);\n}\n\n.el-header {\n  background-color: #D30000;\n  height: 50px !important;\n  padding: 0;\n  margin: 0;\n  z-index: 100;\n}\n\n.el-aside {\n  border-right: 1px solid #ccc;\n  height: calc(80vh - 105px);\n}\n\n.el-menu {\n  border: none;\n}\n\n.el-menu-item:hover {\n  background-color: #f5f5f6 !important;\n}\n\n.el-menu-item {\n  font-size: 12px;\n  padding: 0 0 0 10px !important;\n  margin: 5px 0 !important;\n  height: 30px;\n  line-height: 30px;\n}\n\n.el-menu-item-group {\n  margin-top: 10px;\n}\n\n.el-main {\n  padding: 0;\n}\n</style>"]}]}