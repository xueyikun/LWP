{"remainingRequest":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GH\\LWP\\light-weightplayer\\src\\views\\personal\\Personal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GH\\LWP\\light-weightplayer\\src\\views\\personal\\Personal.vue","mtime":1632135031000},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\babel-loader\\lib\\index.js","mtime":1636408357214},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMaXN0Q2FyZCBmcm9tICJjb21wb25lbnRzL2xpc3RDYXJkL0xpc3RDYXJkLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IExpc3RDYXJkIH0sCiAgbmFtZTogIlBlcnNvbmFsIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g55So5oi35L+h5oGvCiAgICAgIHVzZXJJbmZvOiB7fSwKICAgICAgLy8g5Yib5bu655qE5q2M5Y2VCiAgICAgIGNyZWF0ZWRNdXNpY0xpc3Q6IFtdLAogICAgICAvLyDmlLbol4/nmoTmrYzljZUKICAgICAgY29sbGVjdGVkTXVzaWNMaXN0OiBbXSwKICAgICAgLy8g6K+l55So5oi35piv5ZCm5Li65b2T5YmN55So5oi3CiAgICAgIGlzQ3VycmVudFVzZXI6IGZhbHNlLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOivt+axggogICAgLy8g6I635Y+W55So5oi35L+h5oGvCiAgICBhc3luYyBnZXRVc2VySW5mbygpIHsKICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuJHJlcXVlc3QoCiAgICAgICAgYC91c2VyL2RldGFpbD91aWQ9JHt0aGlzLiRyb3V0ZS5wYXJhbXMudWlkfWAKICAgICAgKTsKICAgICAgaWYgKCFyZXMpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLojrflj5bnlKjmiLfkv6Hmga/lpLHotKUhIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgIHJlcy5kYXRhLnByb2ZpbGVbImxldmVsIl0gPSByZXMuZGF0YS5sZXZlbDsKICAgICAgdGhpcy51c2VySW5mbyA9IHJlcy5kYXRhLnByb2ZpbGU7CiAgICB9LAoKICAgIC8vIOivt+axgueUqOaIt+atjOWNlQogICAgYXN5bmMgZ2V0VXNlck11c2ljTGlzdCgpIHsKICAgICAgbGV0IHRpbWVzdGFtcCA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7CiAgICAgIC8vIOWFiOS7jmxvY2FsU3RvcmFnZemHjOmdouivu+WPlueUqOaIt+S/oeaBryAg5aaC5p6c55m75b2V5oiQ5Yqf5piv5pyJ5a2Y55qECiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRyZXF1ZXN0KCIvdXNlci9wbGF5bGlzdCIsIHsKICAgICAgICB1aWQ6IHRoaXMuJHJvdXRlLnBhcmFtcy51aWQsCiAgICAgICAgdGltZXN0YW1wLAogICAgICB9KTsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgLy8g5a+55pWw5o2u6L+b6KGM5aSE55CG5YiG57G7CiAgICAgIHJlcyA9IHJlcy5kYXRhLnBsYXlsaXN0OwogICAgICBsZXQgaW5kZXggPSByZXMuZmluZEluZGV4KChpdGVtKSA9PiBpdGVtLnN1YnNjcmliZWQgPT0gdHJ1ZSk7CiAgICAgIHJlc1swXS5uYW1lID0gYCR7dGhpcy51c2VySW5mby5uaWNrbmFtZX3llpzmrKLnmoTpn7PkuZBgOwogICAgICB0aGlzLmNyZWF0ZWRNdXNpY0xpc3QgPSByZXMuc2xpY2UoMCwgaW5kZXgpOwogICAgICB0aGlzLmNvbGxlY3RlZE11c2ljTGlzdCA9IHJlcy5zbGljZShpbmRleCk7CiAgICB9LAoKICAgIC8vIOS6i+S7tgogICAgLy8g54K55Ye75q2M5Y2V55qE5Zue6LCDCiAgICBjbGlja0xpc3RDYXJkSXRlbShpZCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJtdXNpY0xpc3REZXRhaWwiLCBwYXJhbXM6IHsgaWQgfSB9KTsKICAgIH0sCgogICAgLy8g54K55Ye76YCA5Ye655m75b2V55qE5Zue6LCDCiAgICBhc3luYyBsb2dvdXQoKSB7CiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRyZXF1ZXN0KCIvbG9nb3V0Iik7CiAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICBpZiAocmVzLmRhdGEuY29kZSAhPSAyMDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKCLpgIDlh7rnmbvlvZXlpLHotKUsIOivt+eojeWQjumHjeivlSEiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOa4heepumRhdGHlkoxsb2NhbHN0b3JhZ2XkuK3nmoTmlbDmja7vvIzku6Xlj4pjb29raWUKICAgICAgLy8gd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ1c2VySW5mbyIsICIiKTsKICAgICAgLy8gdGhpcy5jbGVhckFsbENvb2tpZSgpOwogICAgICAvLyDliKDpmaRsb2NhbHN0b2FyZ2XnmoR1c2VySWQKICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VySWQiKTsKICAgICAgLy8gICDlnKh2dWV45Lit5pu05paw55m75b2V54q25oCBCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRhTG9naW5TdGF0ZSIsIGZhbHNlKTsKICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLpgIDlh7rmiJDlip8hIik7CiAgICAgIHRoaXMuaXNDdXJyZW50VXNlciA9IGZhbHNlOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICAiJHN0b3JlLnN0YXRlLmlzTG9naW4iKGN1cnJlbnQpIHsKICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIikgJiYgY3VycmVudCkgewogICAgICAgIHRoaXMuaXNDdXJyZW50VXNlciA9CiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpID09IHRoaXMuJHJvdXRlLnBhcmFtcy51aWQ7CiAgICAgIH0KICAgIH0sCiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgYXdhaXQgdGhpcy5nZXRVc2VySW5mbygpOwogICAgdGhpcy5nZXRVc2VyTXVzaWNMaXN0KCk7CiAgICAvLyDliKTmlq3or6XnlKjmiLfmmK/kuI3mmK/lvZPliY3nmbvlvZXnlKjmiLcKICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpKSB7CiAgICAgIHRoaXMuaXNDdXJyZW50VXNlciA9CiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySWQiKSA9PSB0aGlzLiRyb3V0ZS5wYXJhbXMudWlkOwogICAgfQogIH0sCn07Cg=="},{"version":3,"sources":["Personal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Personal.vue","sourceRoot":"src/views/personal","sourcesContent":["<template>\n  <div class=\"Personal\">\n    <div class=\"userInfo\" v-if=\"userInfo.avatarUrl\">\n      <div class=\"left\">\n        <img\n          :src=\"userInfo.avatarUrl + '?param=400y400'\"\n          alt=\"\"\n          class=\"avatar\"\n        />\n      </div>\n      <div class=\"right\">\n        <div class=\"rightTop\">\n          <div class=\"username\">\n            <div>{{ userInfo.nickname }}</div>\n            <div\n              class=\"logout\"\n              @click=\"logout\"\n              v-if=\"isCurrentUser && this.$store.state.isLogin\"\n            >\n              <i class=\"iconfont icon-zhuxiao1\"></i>\n              <span>退出登录</span>\n            </div>\n          </div>\n          <div class=\"tags\">\n            <div class=\"level\">{{ \"Lv\" + userInfo.level }}</div>\n            <div class=\"gender\">\n              <!-- 0 保密 1男 2女 -->\n            </div>\n          </div>\n        </div>\n        <div class=\"rightBottom\">\n          <!-- 动态 关注 粉丝 -->\n          <div class=\"dataNums\">\n            <div class=\"numItem\">\n              <div class=\"numItemTop\">{{ userInfo.eventCount }}</div>\n              <div class=\"numItemBottom\">动态</div>\n            </div>\n            <div\n              class=\"numItem\"\n              @click=\"\n                $router.push({\n                  name: 'follows',\n                  params: { uid: $route.params.uid },\n                })\n              \"\n            >\n              <div class=\"numItemTop\">{{ userInfo.newFollows }}</div>\n              <div class=\"numItemBottom\">关注</div>\n            </div>\n            <div\n              class=\"numItem\"\n              @click=\"\n                $router.push({\n                  name: 'followeds',\n                  params: { uid: $route.params.uid },\n                })\n              \"\n            >\n              <div class=\"numItemTop\">{{ userInfo.followeds }}</div>\n              <div class=\"numItemBottom\">粉丝</div>\n            </div>\n          </div>\n          <!-- 其它信息 -->\n          <div class=\"otherInfo\">\n            <div class=\"otherInfoItem\">\n              <div class=\"otherInfoKey\">用户id：</div>\n              <div class=\"ptherInfoValue\">{{ userInfo.userId }}</div>\n            </div>\n            <div class=\"otherInfoItem\">\n              <div class=\"otherInfoKey\">所在地区：</div>\n              <div class=\"ptherInfoValue\">\n                {{ userInfo.province + \" \" + userInfo.city }}\n              </div>\n            </div>\n            <div class=\"otherInfoItem\">\n              <div class=\"otherInfoKey\">个人介绍：</div>\n              <div class=\"ptherInfoValue\">\n                {{ userInfo.signature == \"\" ? \"暂无介绍\" : userInfo.signature }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 歌单 -->\n    <div class=\"musicList\">\n      <div class=\"musicListTitle\" v-if=\"createdMusicList.length != 0\">\n        {{ userInfo.nickname }}创建的歌单({{ createdMusicList.length }})\n      </div>\n      <list-card\n        :listCardData=\"createdMusicList\"\n        @clickListCardItem=\"clickListCardItem\"\n      ></list-card>\n      <div class=\"musicListTitle\" v-if=\"collectedMusicList.length != 0\">\n        {{ userInfo.nickname }}收藏的歌单({{ collectedMusicList.length }})\n      </div>\n      <list-card\n        :listCardData=\"collectedMusicList\"\n        @clickListCardItem=\"clickListCardItem\"\n      ></list-card>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ListCard from \"components/listCard/ListCard.vue\";\nexport default {\n  components: { ListCard },\n  name: \"Personal\",\n  data() {\n    return {\n      // 用户信息\n      userInfo: {},\n      // 创建的歌单\n      createdMusicList: [],\n      // 收藏的歌单\n      collectedMusicList: [],\n      // 该用户是否为当前用户\n      isCurrentUser: false,\n    };\n  },\n  methods: {\n    // 请求\n    // 获取用户信息\n    async getUserInfo() {\n      let res = await this.$request(\n        `/user/detail?uid=${this.$route.params.uid}`\n      );\n      if (!res) {\n        this.$message.error(\"获取用户信息失败!\");\n        return;\n      }\n      // console.log(res);\n      res.data.profile[\"level\"] = res.data.level;\n      this.userInfo = res.data.profile;\n    },\n\n    // 请求用户歌单\n    async getUserMusicList() {\n      let timestamp = Date.parse(new Date());\n      // 先从localStorage里面读取用户信息  如果登录成功是有存的\n      let res = await this.$request(\"/user/playlist\", {\n        uid: this.$route.params.uid,\n        timestamp,\n      });\n      console.log(res);\n      // 对数据进行处理分类\n      res = res.data.playlist;\n      let index = res.findIndex((item) => item.subscribed == true);\n      res[0].name = `${this.userInfo.nickname}喜欢的音乐`;\n      this.createdMusicList = res.slice(0, index);\n      this.collectedMusicList = res.slice(index);\n    },\n\n    // 事件\n    // 点击歌单的回调\n    clickListCardItem(id) {\n      this.$router.push({ name: \"musicListDetail\", params: { id } });\n    },\n\n    // 点击退出登录的回调\n    async logout() {\n      let res = await this.$request(\"/logout\");\n      // console.log(res);\n\n      if (res.data.code != 200) {\n        this.$message(\"退出登录失败, 请稍后重试!\");\n        return;\n      }\n\n      // 清空data和localstorage中的数据，以及cookie\n      // window.localStorage.setItem(\"userInfo\", \"\");\n      // this.clearAllCookie();\n      // 删除localstoarge的userId\n      window.localStorage.removeItem(\"userId\");\n      //   在vuex中更新登录状态\n      this.$store.commit(\"updataLoginState\", false);\n      this.$message.success(\"退出成功!\");\n      this.isCurrentUser = false;\n    },\n  },\n  watch: {\n    \"$store.state.isLogin\"(current) {\n      if (window.localStorage.getItem(\"userId\") && current) {\n        this.isCurrentUser =\n          window.localStorage.getItem(\"userId\") == this.$route.params.uid;\n      }\n    },\n  },\n  async created() {\n    await this.getUserInfo();\n    this.getUserMusicList();\n    // 判断该用户是不是当前登录用户\n    if (window.localStorage.getItem(\"userId\")) {\n      this.isCurrentUser =\n        window.localStorage.getItem(\"userId\") == this.$route.params.uid;\n    }\n  },\n};\n</script>\n\n<style scoped>\n.Personal {\n  height: calc(80vh - 105px);\n  overflow-y: scroll;\n}\n\n.userInfo {\n  margin: 30px 10px;\n  display: flex;\n}\n\n.avatar {\n  margin-top: 5px;\n  height: 150px;\n  width: 150px;\n  object-fit: cover;\n  border-radius: 50%;\n}\n\n.right {\n  margin-left: 20px;\n  flex: 1;\n}\n\n.username {\n  color: #373737;\n  font-size: 22px;\n  font-weight: bold;\n  display: flex;\n  justify-content: space-between;\n}\n\n.logout {\n  margin-right: 10px;\n  color: #373737;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 20px;\n  cursor: pointer;\n  font-weight: lighter;\n  padding: 0 15px;\n  border: 1px solid #ddd;\n  transform: scale(0.9);\n}\n\n.logout:hover {\n  background-color: #f2f2f2;\n}\n\n.logout i {\n  font-size: 12px;\n  margin-right: 3px;\n}\n\n.logout span {\n  font-size: 12px;\n}\n\n.tags {\n  display: flex;\n  margin: 10px 0;\n}\n\n.level {\n  font-size: 12px;\n  transform: scale(0.8) translateX(-10%);\n  background-color: #f0f0f0;\n  width: 100;\n  padding: 2px 8px;\n  border-radius: 10px;\n  color: #373737;\n}\n\n.rightTop {\n  width: 100%;\n  border-bottom: 1px solid #ddd;\n}\n\n.dataNums {\n  display: flex;\n  margin: 10px 0 5px;\n}\n\n.numItem {\n  border-left: 1px solid #eee;\n  padding: 0 25px;\n  text-align: center;\n  cursor: pointer;\n}\n\n.numItem:nth-child(1) {\n  border-left: none;\n  padding-left: 3px;\n}\n\n.numItemTop {\n  color: #373737;\n  font-size: 18px;\n}\n\n.numItemBottom {\n  font-size: 12px;\n  transform: scale(0.8);\n}\n\n.otherInfo {\n  font-size: 12px;\n  transform: scale(0.9) translateX(-5%);\n  user-select: text !important;\n}\n\n.otherInfoItem {\n  display: flex;\n  margin: 5px 0;\n}\n\n.otherInfoKey {\n  color: #2e2e2e;\n}\n\n.otherInfoValue {\n  width: 80%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.musicListTitle {\n  color: #373737;\n  font-weight: bold;\n  font-size: 14px;\n}\n\n.musicList {\n  max-width: 1100px;\n  margin: 0 auto;\n  padding-bottom: 30px;\n}\n</style>\n"]}]}