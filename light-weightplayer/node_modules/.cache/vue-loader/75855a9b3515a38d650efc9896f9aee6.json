{"remainingRequest":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\discover\\discoverChildren\\Ranking.vue?vue&type=style&index=0&id=5ae3884b&scoped=true&lang=css&","dependencies":[{"path":"D:\\vue_cloud_music-master\\light-webplayer\\src\\views\\discover\\discoverChildren\\Ranking.vue","mtime":1636485287731},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\css-loader\\dist\\cjs.js","mtime":1636408356404},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1636408358142},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\postcss-loader\\src\\index.js","mtime":1636408357193},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\vue_cloud_music-master\\light-webplayer\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5yYW5raW5nQ29udGFpbmVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIHdpZHRoOiAxMDAlOwp9CgoucmFua2luZyB7CiAgbWF4LXdpZHRoOiAxMDAwcHg7CiAgcGFkZGluZzogMCAxMHB4Owp9CgoubGlzdENhcmQgewogIG1hcmdpbi10b3A6IDE1cHg7Cn0K"},{"version":3,"sources":["Ranking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Ranking.vue","sourceRoot":"src/views/discover/discoverChildren","sourcesContent":["<template>\n  <!-- 请求到数据前先不进行渲染，避免报错和影响美观 -->\n  <div class=\"rankingContainer\">\n    <div class=\"ranking\" v-if=\"officialListDetail.length != 0\">\n      <div class=\"offical\">\n        <div class=\"title\">官方榜</div>\n        <!-- 用自己封装的table组件 -->\n        <list-table\n          :officialListDetailItem=\"item\"\n          v-for=\"(item, index) in officialListDetail\"\n          :key=\"index\"\n          @handleRowClick=\"handleRowClick\"\n          @handleRowDbClick=\"handleRowDbClick\"\n          @clickCheckAll=\"clickListCardItem\"\n        ></list-table>\n      </div>\n      <div class=\"global\">\n        <div class=\"title\">全球榜</div>\n        <!-- 展示歌单列表 -->\n        <list-card\n          class=\"listCard\"\n          :listCardData=\"globalList\"\n          @clickListCardItem=\"clickListCardItem\"\n        ></list-card>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { handleMusicTime } from \"plugins/utils\";\n\nimport ListTable from \"components/listTable/ListTable.vue\";\nimport ListCard from \"components/listCard/ListCard.vue\";\nexport default {\n  components: { ListTable, ListCard },\n  name: \"Ranking\",\n  data() {\n    return {\n      officialList: [],\n      officialListDetail: [],\n      globalList: [],\n    };\n  },\n  methods: {\n    // 请求\n    // 请求所有榜单\n    async getAllRankings() {\n      let res = await this.$request(\"/toplist\");\n      console.log(res);\n      this.officialList = res.data.list.slice(0, 4);\n      this.globalList = res.data.list.slice(4);\n    },\n    // 根据榜单id请求详细数据\n    // 根据传来的 id 查询歌单\n    async getMusicListDetail(id) {\n      // console.log(this.$route.params.id);\n      let result = await this.$request(\"/playlist/detail\", { id });\n      // console.log(result);\n      result = result.data.playlist;\n      // 对时间进行处理\n      result.tracks.forEach((item, index) => {\n        result.tracks[index].dt = handleMusicTime(item.dt);\n      });\n      this.officialListDetail.push(result);\n    },\n\n    // 事件函数\n    // 行点击事件的回调\n    handleRowClick(event) {\n      // console.log(event);\n      if (document.querySelector(\".selectRow\")) {\n        document.querySelector(\".selectRow\").classList.remove(\"selectRow\");\n      }\n      event.classList.add(\"selectRow\");\n    },\n    // 行双击事件的回调\n    // id 歌单id   index 双击歌曲在歌单中的索引\n    handleRowDbClick({ id, index }) {\n      // console.log(id);\n      // console.log(index);\n      let musicListIndex = this.officialListDetail.findIndex(\n        (item) => item.id == id\n      );\n      console.log(musicListIndex);\n      this.$store.commit(\n        \"updateMusicId\",\n        this.officialListDetail[musicListIndex].tracks[index].id\n      );\n      // 如果歌单发生变化,则提交歌单到vuex\n      if (id != this.$store.state.musicListId) {\n        // 将歌单传到vuex\n        this.$store.commit(\"updateMusicList\", {\n          musicList: this.officialListDetail[musicListIndex].tracks,\n          musicListId: id,\n        });\n      }\n    },\n    // 点击榜单进入歌单详情界面\n    clickListCardItem(id) {\n      if (!this.$store.state.isLogin) {\n        this.$message.error(\"登录后才能查看全部歌曲哦!\");\n        return;\n      }\n      if (id.id) {\n        id = id.id;\n      }\n      this.$router.push({ name: \"musicListDetail\", params: { id } });\n    },\n  },\n  async created() {\n    await this.getAllRankings();\n    this.officialList.forEach((item) => {\n      this.getMusicListDetail(item.id);\n    });\n    // console.log(this.officialListDetail);\n  },\n};\n</script>\n\n<style scoped>\n.rankingContainer {\n  display: flex;\n  justify-content: center;\n  width: 100%;\n}\n\n.ranking {\n  max-width: 1000px;\n  padding: 0 10px;\n}\n\n.listCard {\n  margin-top: 15px;\n}\n</style>"]}]}