{"remainingRequest":"D:\\GH\\node_modules\\babel-loader\\lib\\index.js!D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\GH\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GH\\LWP\\light-weightplayer\\src\\components\\lyricsScroll\\LyricsScroll.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GH\\LWP\\light-weightplayer\\src\\components\\lyricsScroll\\LyricsScroll.vue","mtime":1632135031000},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\babel-loader\\lib\\index.js","mtime":1636408357214},{"path":"D:\\GH\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636408355875},{"path":"D:\\GH\\node_modules\\vue-loader\\lib\\index.js","mtime":1636408357599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIHBsYWNlaG9sZGVySGVpZ2h0ID0gMDsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJMeXJpY3NTY3JvbGwiLAogIHByb3BzOiB7CiAgICBseXJpYzogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogW10KICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDlvZPliY3mrYzor43ntKLlvJUKICAgICAgbHlyaWNzSW5kZXg6IDAKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDlrp7njrDmrYzor43mu5rliqgKICAgIGx5cmljU2Nyb2xsOiBmdW5jdGlvbiBseXJpY1Njcm9sbChjdXJyZW50THlyaWMpIHsKICAgICAgLy8g6I635Y+W5q2M6K+NaXRlbQogICAgICB2YXIgbHlyaWNzQXJyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmx5cmljc0l0ZW0iKTsgLy8g6I635Y+W5q2M6K+N5qGGCgogICAgICB2YXIgbHlyaWNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmx5cmljcyIpOyAvLyBwbGFjZWhvbGRlcueahOmrmOW6pgoKICAgICAgaWYgKHBsYWNlaG9sZGVySGVpZ2h0ID09IDApIHsKICAgICAgICBwbGFjZWhvbGRlckhlaWdodCA9IGx5cmljc0FyclswXS5vZmZzZXRUb3AgLSBseXJpY3Mub2Zmc2V0VG9wOwogICAgICB9IC8vICAg5q2M6K+NaXRlbeWcqOatjOivjeahhueahOmrmOW6piA9IOatjOivjeahhueahG9mZnNldFRvcCAtIOatjOivjWl0ZW3nmoRvZmZzZXRUb3AKICAgICAgLy8gICBjb25zb2xlLmxvZyhjdXJyZW50THlyaWMpOwoKCiAgICAgIGlmIChseXJpY3NBcnJbY3VycmVudEx5cmljIC0gMV0pIHsKICAgICAgICB2YXIgZGlzdGFuY2UgPSBseXJpY3NBcnJbY3VycmVudEx5cmljIC0gMV0ub2Zmc2V0VG9wIC0gbHlyaWNzLm9mZnNldFRvcDsgLy8gICBseXJpY3NBcnJbY3VycmVudEx5cmljXS5zY3JvbGxJbnRvVmlldygpOwoKICAgICAgICBseXJpY3Muc2Nyb2xsVG8oewogICAgICAgICAgYmVoYXZpb3I6ICJzbW9vdGgiLAogICAgICAgICAgdG9wOiBkaXN0YW5jZSAtIHBsYWNlaG9sZGVySGVpZ2h0CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvL+iOt+WPluW9k+WJjeatjOivjee0ouW8lQogICAgZ2V0Q3VycmVudEx5cmljc0luZGV4OiBmdW5jdGlvbiBnZXRDdXJyZW50THlyaWNzSW5kZXgoY3VycmVudFRpbWUpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBseXJpY3NJbmRleCA9IDA7CiAgICAgIHRoaXMubHlyaWMuc29tZShmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChseXJpY3NJbmRleCA8IF90aGlzLmx5cmljLmxlbmd0aCAtIDEpIHsKICAgICAgICAgIGlmIChjdXJyZW50VGltZSA+IGl0ZW1bMF0pIHsKICAgICAgICAgICAgbHlyaWNzSW5kZXggKz0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gY3VycmVudFRpbWUgPD0gaXRlbVswXTsKICAgICAgICB9CiAgICAgIH0pOyAvLyBjb25zb2xlLmxvZyhseXJpY3NJbmRleCk7CgogICAgICB0aGlzLmx5cmljc0luZGV4ID0gbHlyaWNzSW5kZXg7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgLy8g55uR5ZCs5b2T5YmN5pKt5pS+5pe26Ze0CiAgICAiJHN0b3JlLnN0YXRlLmN1cnJlbnRUaW1lIjogZnVuY3Rpb24gJHN0b3JlU3RhdGVDdXJyZW50VGltZShjdXJyZW50VGltZSwgbGFzdFRpbWUpIHsKICAgICAgLy8g5aaC5p6c5Lik5Liq5pe26Ze06Ze06ZqU5pyJMeenkizliJnlj6/lvpfnn6Xov5vluqbmnaHooqvmi5bliqgg6ZyA6KaB6YeN5paw5qCh5YeG5q2M6K+NaW5kZXgKICAgICAgLy8g5b2T5q2M6K+N5pWw6YeP5aSn5LqOMeW5tuS4lOe0ouW8leS4uumbtuaXtizlj6/og73mrYzor43kvY3nva7lt67ot53ovoPlpKcs6LWw6L+Z5LiqaWbov5vooYzlv6vpgJ/ot7PovawKICAgICAgaWYgKGxhc3RUaW1lICYmIE1hdGguYWJzKGN1cnJlbnRUaW1lIC0gbGFzdFRpbWUpID49IDEgfHwgdGhpcy5seXJpY3NJbmRleCA9PSAwICYmIHRoaXMubHlyaWMubGVuZ3RoID4gMSkgewogICAgICAgIC8vIOWkhOeQhuaSreaUvuaXtumXtOi3s+i9rOaXtuatjOivjeS9jee9rueahOagoeWHhgogICAgICAgIGlmICh0aGlzLmx5cmljLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudEx5cmljc0luZGV4KGN1cnJlbnRUaW1lKTsgLy8g5ruR5Yqo5Yiw5b2T5YmN5q2M6K+NCgogICAgICAgICAgdGhpcy5seXJpY1Njcm9sbCh0aGlzLmx5cmljc0luZGV4KTsKICAgICAgICB9CiAgICAgIH0gLy8g5qC55o2u5a6e5pe25pKt5pS+5pe26Ze05a6e546w5q2M6K+N5rua5YqoCgoKICAgICAgaWYgKHRoaXMubHlyaWNzSW5kZXggPCB0aGlzLmx5cmljLmxlbmd0aCkgewogICAgICAgIGlmIChjdXJyZW50VGltZSA+PSB0aGlzLmx5cmljW3RoaXMubHlyaWNzSW5kZXhdWzBdKSB7CiAgICAgICAgICB0aGlzLmx5cmljc0luZGV4ICs9IDE7CiAgICAgICAgICB0aGlzLmx5cmljU2Nyb2xsKHRoaXMubHlyaWNzSW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOebkeWQrHZ1ZXjkuK3nmoRtdXNpY0lkIOmHjee9ruatjOivjee0ouW8lQogICAgIiRzdG9yZS5zdGF0ZS5tdXNpY0lkIjogZnVuY3Rpb24gJHN0b3JlU3RhdGVNdXNpY0lkKG11c2ljSWQpIHsKICAgICAgdGhpcy5seXJpY3NJbmRleCA9IDA7CiAgICB9LAogICAgbHlyaWM6IGZ1bmN0aW9uIGx5cmljKGN1cnJlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygi6I635Y+W5LqG5q2M6K+NIik7IC8vIOWkp+S6juS4gOenku+8jOivtOaYjuatjOivjeWcqDHnp5LlkI7miY3or7fmsYLmiJDlip8g5q2M6K+N5Y+v6IO95LiN6IO96ams5LiK6Lez6L2s5Yiw5b2T5YmN5pe26Ze0IOi/memHjOi/m+ihjOagoeWHhgoKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRUaW1lID4gMSkgewogICAgICAgIC8vIOWkhOeQhuaSreaUvuaXtumXtOi3s+i9rOaXtuatjOivjeS9jee9rueahOagoeWHhgogICAgICAgIGlmICh0aGlzLmx5cmljLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudEx5cmljc0luZGV4KHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRUaW1lKTsKICAgICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8g5ruR5Yqo5Yiw5b2T5YmN5q2M6K+NCiAgICAgICAgICAgIF90aGlzMi5seXJpY1Njcm9sbChfdGhpczIubHlyaWNzSW5kZXgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge30sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHt9Cn07"},{"version":3,"sources":["LyricsScroll.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"lyrics\">\n    <!-- 占位 -->\n    <div class=\"placeholder\"></div>\n    <!-- 因为歌词快了一句,所以减1 -->\n    <!-- 歌词item -->\n    <div\n      class=\"lyricsItem\"\n      :class=\"lyricsIndex - 1 == index ? 'currentLyric' : ''\"\n      v-for=\"(item, index) in lyric\"\n      :key=\"index\"\n    >\n      {{ item[1] }}\n    </div>\n    <!-- 占位 -->\n    <div class=\"placeholder\"></div>\n  </div>\n</template>\n\n<script>\nlet placeholderHeight = 0;\nexport default {\n  name: \"LyricsScroll\",\n  props: {\n    lyric: {\n      type: Array,\n      default: [],\n    },\n  },\n  data() {\n    return {\n      // 当前歌词索引\n      lyricsIndex: 0,\n    };\n  },\n  methods: {\n    // 实现歌词滚动\n    lyricScroll(currentLyric) {\n      // 获取歌词item\n      let lyricsArr = document.querySelectorAll(\".lyricsItem\");\n      // 获取歌词框\n      let lyrics = document.querySelector(\".lyrics\");\n      // placeholder的高度\n      if (placeholderHeight == 0) {\n        placeholderHeight = lyricsArr[0].offsetTop - lyrics.offsetTop;\n      }\n      //   歌词item在歌词框的高度 = 歌词框的offsetTop - 歌词item的offsetTop\n      //   console.log(currentLyric);\n      if (lyricsArr[currentLyric - 1]) {\n        let distance = lyricsArr[currentLyric - 1].offsetTop - lyrics.offsetTop;\n        //   lyricsArr[currentLyric].scrollIntoView();\n        lyrics.scrollTo({\n          behavior: \"smooth\",\n          top: distance - placeholderHeight,\n        });\n      }\n    },\n    //获取当前歌词索引\n    getCurrentLyricsIndex(currentTime) {\n      let lyricsIndex = 0;\n      this.lyric.some((item) => {\n        if (lyricsIndex < this.lyric.length - 1) {\n          if (currentTime > item[0]) {\n            lyricsIndex += 1;\n          }\n          return currentTime <= item[0];\n        }\n      });\n      // console.log(lyricsIndex);\n      this.lyricsIndex = lyricsIndex;\n    },\n  },\n  watch: {\n    // 监听当前播放时间\n    \"$store.state.currentTime\"(currentTime, lastTime) {\n      // 如果两个时间间隔有1秒,则可得知进度条被拖动 需要重新校准歌词index\n      // 当歌词数量大于1并且索引为零时,可能歌词位置差距较大,走这个if进行快速跳转\n      if (\n        (lastTime && Math.abs(currentTime - lastTime) >= 1) ||\n        (this.lyricsIndex == 0 && this.lyric.length > 1)\n      ) {\n        // 处理播放时间跳转时歌词位置的校准\n        if (this.lyric.length > 1) {\n          this.getCurrentLyricsIndex(currentTime);\n          // 滑动到当前歌词\n          this.lyricScroll(this.lyricsIndex);\n        }\n      }\n      // 根据实时播放时间实现歌词滚动\n      if (this.lyricsIndex < this.lyric.length) {\n        if (currentTime >= this.lyric[this.lyricsIndex][0]) {\n          this.lyricsIndex += 1;\n          this.lyricScroll(this.lyricsIndex);\n        }\n      }\n    },\n    // 监听vuex中的musicId 重置歌词索引\n    \"$store.state.musicId\"(musicId) {\n      this.lyricsIndex = 0;\n    },\n    lyric(current) {\n      console.log(\"获取了歌词\");\n      // 大于一秒，说明歌词在1秒后才请求成功 歌词可能不能马上跳转到当前时间 这里进行校准\n      if (this.$store.state.currentTime > 1) {\n        // 处理播放时间跳转时歌词位置的校准\n        if (this.lyric.length > 1) {\n          this.getCurrentLyricsIndex(this.$store.state.currentTime);\n          this.$nextTick(() => {\n            // 滑动到当前歌词\n            this.lyricScroll(this.lyricsIndex);\n          });\n        }\n      }\n    },\n  },\n  created() {},\n  mounted() {},\n};\n</script>\n\n<style scoped>\n.lyrics {\n  width: 100%;\n  height: 275px;\n  font-size: 12px;\n  text-align: center;\n  overflow-y: scroll;\n  /* overflow: scroll; */\n}\n\n.lyrics::-webkit-scrollbar {\n  display: none;\n}\n\n.lyricsItem {\n  font-size: 12px;\n  /* height: 20px; */\n  margin: 25px 20px;\n  transition: all 0.5s;\n  line-height: 20px;\n}\n\n.currentLyric {\n  font-weight: 600;\n  font-size: 14px;\n  color: black;\n}\n\n.placeholder {\n  width: 100%;\n  height: 40%;\n}\n</style>"],"sourceRoot":"src/components/lyricsScroll"}]}